este es el codigo actualizado hasta el momento